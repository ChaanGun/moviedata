<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üé¨ Movie Database</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: #fff;
      min-height: 100vh;
    }

    .header {
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
    }

    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .controls {
      max-width: 1200px;
      margin: 30px auto;
      padding: 0 20px;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .search-box {
      flex: 1;
      min-width: 300px;
      max-width: 500px;
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: 12px 20px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      font-size: 1rem;
      outline: none;
      transition: all 0.3s;
    }

    .search-box input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-box input:focus {
      border-color: #4ecdc4;
      background: rgba(255, 255, 255, 0.15);
    }

    .search-database-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 20px;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
      color: #fff;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s;
    }

    .search-database-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4);
    }

    .filter-section {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto 20px;
      padding: 0 20px;
    }

    .filter-label {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 10px;
      display: block;
    }

    .filter-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.9rem;
    }

    .btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    .btn.active {
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
    }

    .loading {
      text-align: center;
      padding: 50px;
      font-size: 1.5rem;
    }

    .search-info {
      text-align: center;
      padding: 10px;
      background: rgba(78, 205, 196, 0.2);
      margin: 20px auto;
      max-width: 800px;
      border-radius: 10px;
      font-size: 0.9rem;
    }

    .movies {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 30px;
      padding: 30px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .movie {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      overflow: hidden;
      transition: all 0.3s;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .movie:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      border-color: #4ecdc4;
    }

    .movie-poster {
      width: 100%;
      height: 400px;
      object-fit: cover;
      display: block;
    }

    .movie-info {
      padding: 20px;
    }

    .movie-title {
      font-size: 1.3rem;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .movie-meta {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.7);
    }

    .movie-meta span {
      background: rgba(255, 255, 255, 0.1);
      padding: 4px 10px;
      border-radius: 10px;
    }

    .rating {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      background: rgba(255, 215, 0, 0.2);
      padding: 4px 10px;
      border-radius: 10px;
      color: #ffd700;
    }

    .movie-description {
      font-size: 0.9rem;
      line-height: 1.5;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 10px;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .movie-credits {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.6);
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .movie-credits div {
      margin-bottom: 5px;
    }

    .movie-credits strong {
      color: #4ecdc4;
    }

    .no-results {
      text-align: center;
      padding: 50px;
      font-size: 1.2rem;
      color: rgba(255, 255, 255, 0.6);
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.8rem;
      }
      
      .movies {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        padding: 20px;
      }

      .movie-poster {
        height: 300px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üé¨ Movie Database</h1>
    <div class="controls">
      <div class="search-box">
        <input type="text" id="searchInput" placeholder="üîç Search movie title..." />
      </div>
      <button class="search-database-btn" id="searchDatabaseBtn">Search Database</button>
    </div>
  </div>

  <div class="filter-section">
    <div class="filter-label">üé≠ Category:</div>
    <div class="filter-buttons">
      <button class="btn active" data-category="popular">Popular</button>
      <button class="btn" data-category="top_rated">Top Rated</button>
      <button class="btn" data-category="upcoming">Upcoming</button>
      <button class="btn" data-category="now_playing">Now Playing</button>
    </div>
  </div>

  <div class="filter-section">
    <div class="filter-label">üåç Language:</div>
    <div class="filter-buttons">
      <button class="btn active" data-language="">All Languages</button>
      <button class="btn" data-language="en">English</button>
      <button class="btn" data-language="hi">Hindi</button>
      <button class="btn" data-language="te">Telugu</button>
      <button class="btn" data-language="ml">Malayalam</button>
      <button class="btn" data-language="ta">Tamil</button>
      <button class="btn" data-language="ko">Korean</button>
      <button class="btn" data-language="es">Spanish</button>
      <button class="btn" data-language="tl">Filipino</button>
      <button class="btn" data-language="id">Indonesian</button>
    </div>
  </div>

  <div id="searchInfo" class="search-info" style="display: none;"></div>
  <div id="loading" class="loading">Loading movies...</div>
  <div class="movies" id="movies"></div>

  <script>
    const apiKey = '0af72bb91d37a3dcb9147b053fbc7a5c';
    let currentCategory = 'popular';
    let currentLanguage = '';
    let allMovies = [];
    let isSearchMode = false;

    const movieContainer = document.getElementById('movies');
    const loadingDiv = document.getElementById('loading');
    const searchInput = document.getElementById('searchInput');
    const searchDatabaseBtn = document.getElementById('searchDatabaseBtn');
    const searchInfo = document.getElementById('searchInfo');
    const categoryBtns = document.querySelectorAll('[data-category]');
    const languageBtns = document.querySelectorAll('[data-language]');

    // Discover movies by language and category
    async function discoverMovies(category = 'popular', language = '') {
      try {
        loadingDiv.style.display = 'block';
        movieContainer.innerHTML = '';
        searchInfo.style.display = 'none';
        isSearchMode = false;
        
        let apiURL;
        
        if (language) {
          // Use discover endpoint for language filtering
          const sortBy = category === 'popular' ? 'popularity.desc' : 
                        category === 'top_rated' ? 'vote_average.desc' : 
                        category === 'upcoming' ? 'release_date.desc' : 
                        'primary_release_date.desc';
          
          apiURL = `https://api.themoviedb.org/3/discover/movie?api_key=${apiKey}&language=en-US&sort_by=${sortBy}&with_original_language=${language}&page=1&vote_count.gte=10`;
          
          if (category === 'upcoming') {
            const today = new Date().toISOString().split('T')[0];
            apiURL += `&primary_release_date.gte=${today}`;
          } else if (category === 'now_playing') {
            const today = new Date();
            const thirtyDaysAgo = new Date(today.setDate(today.getDate() - 30)).toISOString().split('T')[0];
            const futureDate = new Date().toISOString().split('T')[0];
            apiURL += `&primary_release_date.gte=${thirtyDaysAgo}&primary_release_date.lte=${futureDate}`;
          }
        } else {
          // Use regular movie endpoint
          apiURL = `https://api.themoviedb.org/3/movie/${category}?api_key=${apiKey}&language=en-US&page=1`;
        }
        
        const res = await fetch(apiURL);
        const data = await res.json();
        
        if (!data.results || data.results.length === 0) {
          loadingDiv.style.display = 'none';
          movieContainer.innerHTML = '<div class="no-results">No movies found for this combination</div>';
          return;
        }
        
        // Fetch detailed info for each movie (to get cast and crew)
        const moviesWithDetails = await Promise.all(
          data.results.slice(0, 20).map(async (movie) => {
            try {
              const detailsRes = await fetch(
                `https://api.themoviedb.org/3/movie/${movie.id}?api_key=${apiKey}&append_to_response=credits`
              );
              const details = await detailsRes.json();
              return details;
            } catch (error) {
              return null;
            }
          })
        );
        
        allMovies = moviesWithDetails.filter(m => m !== null).map(movie => ({
          id: '',
          title: movie.title,
          year: movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A',
          duration: movie.runtime ? `${Math.floor(movie.runtime / 60)}h ${movie.runtime % 60}m` : 'N/A',
          rating: movie.adult ? 'R' : 'PG-13',
          genre: movie.genres ? movie.genres.map(g => g.name).join(', ') : 'N/A',
          language: movie.original_language ? movie.original_language.toUpperCase() : 'N/A',
          imdb: movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A',
          subtitles: movie.original_language !== 'en',
          poster: movie.poster_path ? `https://image.tmdb.org/t/p/w500${movie.poster_path}` : 'placeholder.png',
          youtubeId: '',
          description: movie.overview || 'No description available',
          director: movie.credits?.crew.find(person => person.job === 'Director')?.name || 'N/A',
          actors: movie.credits?.cast ? movie.credits.cast.slice(0, 5).map(actor => actor.name).join(', ') : 'N/A'
        }));
        
        // Log the formatted output to console
        console.log('=== MOVIE DATA ===');
        console.log(JSON.stringify(allMovies, null, 4));
        
        displayMovies(allMovies);
        loadingDiv.style.display = 'none';
      } catch (error) {
        console.error('Error fetching movies:', error);
        loadingDiv.innerHTML = '‚ùå Error loading movies. Please try again.';
      }
    }

    // Search entire TMDb database
    async function searchDatabase(query, language = '') {
      if (!query.trim()) {
        alert('Please enter a movie title to search');
        return;
      }

      try {
        loadingDiv.style.display = 'block';
        movieContainer.innerHTML = '';
        searchInfo.style.display = 'none';
        isSearchMode = true;
        
        let searchURL = `https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&language=en-US&query=${encodeURIComponent(query)}&page=1`;
        
        // Add language filter if selected
        if (language) {
          searchURL += `&with_original_language=${language}`;
        }
        
        const res = await fetch(searchURL);
        const data = await res.json();
        
        const languageName = language ? languageBtns[Array.from(languageBtns).findIndex(btn => btn.dataset.language === language)].textContent : 'All Languages';
        searchInfo.style.display = 'block';
        searchInfo.textContent = `üîç Found ${data.total_results} results for "${query}" in ${languageName}`;
        
        if (data.results.length === 0) {
          loadingDiv.style.display = 'none';
          movieContainer.innerHTML = '<div class="no-results">No movies found</div>';
          return;
        }
        
        // Fetch detailed info for each movie
        const moviesWithDetails = await Promise.all(
          data.results.slice(0, 20).map(async (movie) => {
            try {
              const detailsRes = await fetch(
                `https://api.themoviedb.org/3/movie/${movie.id}?api_key=${apiKey}&append_to_response=credits`
              );
              const details = await detailsRes.json();
              return details;
            } catch (error) {
              return null;
            }
          })
        );
        
        allMovies = moviesWithDetails.filter(m => m !== null).map(movie => ({
          id: '',
          title: movie.title,
          year: movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A',
          duration: movie.runtime ? `${Math.floor(movie.runtime / 60)}h ${movie.runtime % 60}m` : 'N/A',
          rating: movie.adult ? 'R' : 'PG-13',
          genre: movie.genres ? movie.genres.map(g => g.name).join(', ') : 'N/A',
          language: movie.original_language ? movie.original_language.toUpperCase() : 'N/A',
          imdb: movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A',
          subtitles: movie.original_language !== 'en',
          poster: movie.poster_path ? `https://image.tmdb.org/t/p/w500${movie.poster_path}` : 'placeholder.png',
          youtubeId: '',
          description: movie.overview || 'No description available',
          director: movie.credits?.crew.find(person => person.job === 'Director')?.name || 'N/A',
          actors: movie.credits?.cast ? movie.credits.cast.slice(0, 5).map(actor => actor.name).join(', ') : 'N/A'
        }));
        
        // Log the formatted output to console
        console.log('=== SEARCH RESULTS ===');
        console.log(JSON.stringify(allMovies, null, 4));
        
        displayMovies(allMovies);
        loadingDiv.style.display = 'none';
      } catch (error) {
        console.error('Error searching database:', error);
        loadingDiv.innerHTML = '‚ùå Error searching database.';
      }
    }

    // Display movies
    function displayMovies(movies) {
      movieContainer.innerHTML = '';
      
      if (movies.length === 0) {
        movieContainer.innerHTML = '<div class="no-results">No movies found</div>';
        return;
      }

      movies.forEach((movie, index) => {
        const movieCard = document.createElement('div');
        movieCard.classList.add('movie');
        movieCard.innerHTML = `
          <img src="${movie.poster}" alt="${movie.title}" class="movie-poster" onerror="this.src='https://via.placeholder.com/500x750?text=No+Poster'" />
          <div class="movie-info">
            <div class="movie-title">${movie.title}</div>
            <div class="movie-meta">
              <span>${movie.year}</span>
              <span>${movie.duration}</span>
              <span>${movie.rating}</span>
              <span class="rating">‚≠ê ${movie.imdb}</span>
            </div>
            <div class="movie-meta">
              <span>${movie.genre}</span>
              <span>${movie.language}</span>
            </div>
            <div class="movie-description">${movie.description}</div>
            <div class="movie-credits">
              <div><strong>Director:</strong> ${movie.director}</div>
              <div><strong>Actors:</strong> ${movie.actors}</div>
            </div>
          </div>
        `;
        
        // Add click event to log individual movie data
        movieCard.addEventListener('click', () => {
          console.log('\n=== üé¨ CLICKED MOVIE DATA ===');
          console.log(JSON.stringify(movie, null, 4));
          console.log('\n=== COPY-PASTE READY ===');
          console.log(`{
    id: ,
    title: "${movie.title}",
    year: ${movie.year},
    duration: "${movie.duration}",
    rating: "${movie.rating}",
    genre: "${movie.genre}",
    language: "${movie.language}",
    imdb: "${movie.imdb}",
    subtitles: ${movie.subtitles},
    poster: "${movie.poster}",
    youtubeId: "",
    description: "${movie.description.replace(/"/g, '\\"')}",
    director: "${movie.director}",
    actors: "${movie.actors}"
},`);
          
          // Visual feedback
          movieCard.style.borderColor = '#4ecdc4';
          movieCard.style.boxShadow = '0 0 20px rgba(78, 205, 196, 0.6)';
          setTimeout(() => {
            movieCard.style.borderColor = 'rgba(255, 255, 255, 0.1)';
            movieCard.style.boxShadow = 'none';
          }, 1000);
          
          alert(`‚úÖ Movie data for "${movie.title}" has been logged to the console!\n\nPress F12 to open Developer Tools and see the formatted JavaScript object.`);
        });
        
        movieContainer.appendChild(movieCard);
      });
    }

    // Database search button
    searchDatabaseBtn.addEventListener('click', () => {
      const query = searchInput.value.trim();
      if (query) {
        searchDatabase(query, currentLanguage);
      }
    });

    // Enter key to search database
    searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        const query = searchInput.value.trim();
        if (query) {
          searchDatabase(query, currentLanguage);
        }
      }
    });

    // Category switching
    categoryBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        categoryBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentCategory = btn.dataset.category;
        searchInput.value = '';
        discoverMovies(currentCategory, currentLanguage);
      });
    });

    // Language switching
    languageBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        languageBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLanguage = btn.dataset.language;
        searchInput.value = '';
        discoverMovies(currentCategory, currentLanguage);
      });
    });

    // Initial load
    if (apiKey) {
      discoverMovies(currentCategory, currentLanguage);
    } else {
      loadingDiv.innerHTML = '‚ö†Ô∏è Please add your TMDb API key to the script';
    }
  </script>
</body>
</html>
